:original_name: en-us_topic_0000002142831253.html

.. _en-us_topic_0000002142831253:

Querying LTS Log Configurations
===============================

API Description
---------------

This API is used to query LTS log configurations.

Restrictions
------------

This API is available only for audit logs.

URI
---

-  URI format

   GET https://{Endpoint}/v3/{project_id}/instances/logs/lts-configs

   .. table:: **Table 1** Path parameters

      +------------+-----------+--------+------------------------------------------------------------------------------------------------------------------+
      | Parameter  | Mandatory | Type   | Description                                                                                                      |
      +============+===========+========+==================================================================================================================+
      | project_id | Yes       | String | Project ID of a tenant in a region. To obtain the project ID, see :ref:`Obtaining a Project ID <dds_projectid>`. |
      +------------+-----------+--------+------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 2** Query parameters

      +--------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Name   | Mandatory | Type    | Description                                                                                                                                                                                                                       |
      +========+===========+=========+===================================================================================================================================================================================================================================+
      | offset | No        | Integer | Index offset. If **offset** is set to *N*, the resource query starts from the N+1 piece of data. The default value is **0**, indicating that the query starts from the first piece of data. The value must be a positive integer. |
      +--------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | limit  | No        | Integer | Number of records to be queried. The value ranges from 0 to 50. If this parameter is not transferred, the log configurations of the first 50 DB instances are queried by default.                                                 |
      +--------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 3** Request parameters

      ============ ========= ====== =============================
      Parameter    Mandatory Type   Description
      ============ ========= ====== =============================
      X-Auth-Token Yes       String User token obtained from IAM.
      ============ ========= ====== =============================

Requests
--------

-  Parameter description

   None

-  Example request

   Query the log configuration of the first 10 DB instances from the first piece of data.

   GET https://dds.eu-de.otc.t-systems.com/v3/619d3e78f61b4be68bc5aa0b59edcf7b/instances/logs/lts-configs?offset=0&limit=10

Responses
---------

-  Parameter description

   .. table:: **Table 4** Response body parameters

      +----------------------+-------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
      | Parameter            | Type                                                                                | Description                                                                                                                |
      +======================+=====================================================================================+============================================================================================================================+
      | instance_lts_configs | Array of :ref:`Table 5 <en-us_topic_0000002142831253__table71681845192513>` objects | LTS log configuration and brief information about each instance.                                                           |
      +----------------------+-------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
      | total_count          | Integer                                                                             | Total number of cloud service log configurations that can be queried, which is equal to the total number of DDS instances. |
      +----------------------+-------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000002142831253__table71681845192513:

   .. table:: **Table 5** instance_lts_configs

      +-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      | Parameter   | Type                                                                                        | Description                                                                                                |
      +=============+=============================================================================================+============================================================================================================+
      | instance    | :ref:`Table 6 <en-us_topic_0000002142831253__table4337123910277>` object                    | Brief information about an instance.                                                                       |
      +-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
      | lts_configs | Array of :ref:`Table lts_configs <en-us_topic_0000002142831253__table186524811314>` objects | LTS log configuration details. If no LTS log stream is configured, no response is returned for this field. |
      +-------------+---------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000002142831253__table4337123910277:

   .. table:: **Table 6** instance

      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter             | Type                                                                     | Description                                                                                                                                                                                     |
      +=======================+==========================================================================+=================================================================================================================================================================================================+
      | id                    | String                                                                   | DDS Instance ID, which can be obtained by calling the API for querying instances and details. If there are no instances available, create one by calling the API used for creating an instance. |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | name                  | String                                                                   | DDS Instance name.                                                                                                                                                                              |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | mode                  | String                                                                   | Instance type, which can be single node, replica set, or cluster.                                                                                                                               |
      |                       |                                                                          |                                                                                                                                                                                                 |
      |                       |                                                                          | Enumerated values:                                                                                                                                                                              |
      |                       |                                                                          |                                                                                                                                                                                                 |
      |                       |                                                                          | -  **ReplicaSingle**                                                                                                                                                                            |
      |                       |                                                                          | -  **ReplicaSet**                                                                                                                                                                               |
      |                       |                                                                          | -  **Sharding**                                                                                                                                                                                 |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | datastore             | :ref:`Table 7 <en-us_topic_0000002142831253__table1439519562296>` object | DB engine and version of the DB instance.                                                                                                                                                       |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | status                | String                                                                   | Instance status.                                                                                                                                                                                |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | enterprise_project_id | String                                                                   | ID of the enterprise project to which the instance belongs. For the default enterprise project, the value is **0**. For other enterprise projects, see *Enterprise Management User Guide*.      |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | actions               | Array of strings                                                         | All actions that are being executed on an instance.                                                                                                                                             |
      +-----------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000002142831253__table1439519562296:

   .. table:: **Table 7** datastore

      ========= ====== ====================================
      Parameter Type   Description
      ========= ====== ====================================
      type      String DB engine. The value is **mongodb**.
      version   String Database major version.
      ========= ====== ====================================

   .. _en-us_topic_0000002142831253__table186524811314:

   .. table:: **Table 8** lts_configs

      +---------------+---------+------------------------------------------------------------------------------------------------+
      | Parameter     | Type    | Description                                                                                    |
      +===============+=========+================================================================================================+
      | log_type      | String  | LTS log type. This parameter cannot be left empty. The only supported option is **audit_log**. |
      +---------------+---------+------------------------------------------------------------------------------------------------+
      | lts_group_id  | String  | LTS log group ID.                                                                              |
      +---------------+---------+------------------------------------------------------------------------------------------------+
      | lts_stream_id | String  | LTS log stream ID.                                                                             |
      +---------------+---------+------------------------------------------------------------------------------------------------+
      | enabled       | Boolean | Indicates whether to upload logs to LTS.                                                       |
      +---------------+---------+------------------------------------------------------------------------------------------------+

-  Example response

   .. code-block:: text

      {
        "total_count" : 1,
        "instance_lts_configs" : [ {
          "instance" : {
            "id" : "520c58ba00a3497e97ce0b9604874dd6in02",
            "name" : "dds-1f84",
            "mode" : "ReplicaSingle",
            "datastore" : {
              "type" : "mongodb",
              "version" : 4.0
            },
            "status" : "normal",
            "enterprise_project_id" : "0",
            "actions" : [ "OPS_AUDIT_LOG" ]
          },
          "lts_configs" : [ {
            "log_type" : "audit_log",
            "lts_group_id" : "ec6dc499-1a63-4229-a0c2-a2afa8bcfc95",
            "lts_stream_id" : "cae69d2e-378b-41dd-b3c9-3ca1cd5335bc",
            "enabled" : true
          } ]
        } ]
      }

Status Code
-----------

=========== =======================
Status Code Description
=========== =======================
200         Success.
default     Client or server error.
=========== =======================

Error Code
----------

For details, see :ref:`Error Code <dds_error_code>`.

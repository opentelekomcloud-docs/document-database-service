:original_name: dds_02_0012.html

.. _dds_02_0012:

Creating a Replica Set Instance
===============================

Scenarios
---------

This section describes how to create a replica set instance on the DDS management console. DDS allows you to tailor your compute resources and storage space to your business needs.

You can use your account to create up to 50 replica set instances. To create more replica set instances, click |image1| in the upper right corner of the management console. On the **Service Quota** page, click **Increase Quota** to apply for quotas.

**Procedure**
-------------

#. :ref:`Log in to the DDS console. <dds_02_0043>`
#. On the **Instance Management** page, click **Create DB Instance**.
#. On the displayed page, select your DB instance specifications and click **Create Now**.

   .. table:: **Table 1** Basic information

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                   |
      +===================================+===============================================================================================================================================================================================================================================================================================================================================+
      | Region                            | A region where the tenant is located. It can be changed in the upper left corner. For details, see section :ref:`Regions and AZs <dds_01_0027>`.                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   |    DB instances deployed in different regions cannot communicate with each other through a private network, and you cannot change the region of a DB instance once it is created. Exercise caution when selecting a region.                                                                                                                   |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | DB Instance Name                  | The DB instance name can be 4 to 64 characters long. It must start with a letter and can contain only uppercase letters, lowercase letters, digits, hyphens (-), and underscores (_).                                                                                                                                                         |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | After the DB instance is created, you can change the DB instance name. For details, see section :ref:`Changing a DB Instance Name <dds_03_0075>`.                                                                                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Database Type                     | Community Edition                                                                                                                                                                                                                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | DB Instance Type                  | Select **Replica set**.                                                                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | A replica set consists of the primary node, secondary node, and hidden node. If a primary node goes down or becomes faulty, a secondary node is automatically assigned to the primary role and continues normal operation. If a secondary node is unavailable, a hidden node will take the role of the secondary to ensure high availability. |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Compatible MongoDB Version        | -  4.4                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  4.2                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  4.0                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  3.4                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  3.2                                                                                                                                                                                                                                                                                                                                        |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Storage Type                      | Ultra-high I/O                                                                                                                                                                                                                                                                                                                                |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Storage Engine                    | -  WiredTiger                                                                                                                                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   |    WiredTiger is the default storage engine of DDS 3.2, 3.4 and 4.0. WiredTiger provides different granularity concurrency control and compression mechanism for data management. It can provide the best performance and storage efficiency for different kinds of applications.                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | -  RocksDB                                                                                                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   |    RocksDB is the default storage engine of DDS 4.2 and 4.4. RocksDB supports efficient point lookup, range scan, and high-speed write. RocksDB can be used as the underlying data storage engine of DDS and is suitable for scenarios with a large number of write operations.                                                               |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | AZ                                | An AZ is a part of a region with its own independent power supplies and networks. AZs are physically isolated but can communicate through an internal network connection. For details, see section :ref:`Regions and AZs <dds_01_0027>`.                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | -  Instances can be deployed in one or three AZ(s). Selecting multiple AZs distributes the nodes between them.                                                                                                                                                                                                                                |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Disk Encryption                   | -  **Disabled**: Disable the encryption function.                                                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | -  **Enabled**: Enable encryption. This feature improves data security but slightly affects read/write performance.                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   |    **Key Name**: Select or create a private key, which is the tenant key.                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                               |
      |                                   |    -  After an instance is created, the disk encryption status and the key cannot be changed. The backup data stored in OBS is encrypted.                                                                                                                                                                                                     |
      |                                   |    -  Backups of replica sets are physical backups. If disk encryption is enabled, backup data will be encrypted.                                                                                                                                                                                                                             |
      |                                   |    -  To check whether the disk is encrypted, you can view **Disk Encrypted** in the DB instance list.                                                                                                                                                                                                                                        |
      |                                   |    -  If disk encryption or backup data encryption is enabled, keep the key properly. Once the key is disabled, deleted, or frozen, the database will be unavailable and data may not be restored.                                                                                                                                            |
      |                                   |    -  For details about how to create a key, see the "Creating a CMK" section in the *Key Management Service User Guide*.                                                                                                                                                                                                                     |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 2** Specifications

      +---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter     | Description                                                                                                                                                                                                                                                                          |
      +===============+======================================================================================================================================================================================================================================================================================+
      | Node Class    | For details about the DB instance specifications, see section :ref:`DB Instance Specifications <dds_01_0024>`. After a DB instance is created, you can change its CPU and memory. For details, see section :ref:`Changing a Replica Set DB Instance Class <en-us_topic_0104721795>`. |
      +---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Storage Space | The value ranges from 10 GB to 3000 GB and must be a multiple of 10.                                                                                                                                                                                                                 |
      +---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 3** Network

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                               |
      +===================================+===========================================================================================================================================================================================================================================================================================================================================================================================================+
      | VPC                               | The VPC where your DB instances are located. A VPC isolates networks for different services, so you can easily manage and configure internal networks and change network configuration. For details about how to create a VPC, see section "Creating a VPC" in the *Virtual Private Cloud User Guide*. For details about the constraints on the use of VPCs, see :ref:`Connection Methods <dds_02_0042>`. |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |    After the DDS instance is created, the VPC cannot be changed.                                                                                                                                                                                                                                                                                                                                          |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Subnet                            | A subnet provides dedicated network resources that are logically isolated from other networks for network security.                                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   | After the instance is created, you can change the private IP address assigned by the subnet. For details, see :ref:`Changing a Private IP Address <dds_03_0070>`.                                                                                                                                                                                                                                         |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Security Group                    | A security group controls access between DDS and other services for security.                                                                                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |    Ensure that the security group rule you set allows clients to access DB instances. For example, select the TCP protocol with inbound direction, input the default port number **8635**, and enter a subnet IP address or select a security group that the DB instance belongs to.                                                                                                                      |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | SSL                               | Secure Sockets Layer (SSL) certificates set up encrypted connections between clients and servers, preventing data from being tampered with or stolen during transmission.                                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   | You can enable SSL to improve data security. After a DB instance is created, you can connect to it using SSL.                                                                                                                                                                                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Cross-CIDR Access                 | -  Configure                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |    Add the VPC CIDR block of your client. Ensure that the ECS where your client is installed can connect to the DB instance.                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |       -  To ensure the ECS and the DB instance can communicate with each other, configure a VPC peering connection by referring to section "VPC Peering Connection Overview" in the *Virtual Private Cloud User Guide*.                                                                                                                                                                                   |
      |                                   |       -  Up to 30 CIDR blocks can be configured, and each of them can overlap but they cannot be the same. That is, the source CIDR blocks can overlap but cannot be the same.                                                                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   | -  Skip                                                                                                                                                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |    Configure the subnet of the client later. After a DB instance is created, you can configure cross-CIDR access by referring to :ref:`Configuring Cross-CIDR Access for Replica Set Instances <dds_03_0100>`.                                                                                                                                                                                            |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 4** Database configuration

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                     |
      +===================================+=================================================================================================================================================================================================================+
      | Administrator                     | The default account is **rwuser**.                                                                                                                                                                              |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Administrator Password            | Set a password for the administrator. The password must be 8 to 32 characters in length and contain uppercase letters, lowercase letters, digits, and any of the following special characters: ``~!@#%^*-_=+?`` |
      |                                   |                                                                                                                                                                                                                 |
      |                                   | Keep this password secure. If lost, the system cannot retrieve it for you.                                                                                                                                      |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Confirm Password                  | Enter the administrator password again.                                                                                                                                                                         |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Replica Set Parameter Template    | The parameters that apply to the replica set instances. After a DB instance is created, you can change the parameter template you configured for the DB instance to bring out the best performance.             |
      |                                   |                                                                                                                                                                                                                 |
      |                                   | For details, see :ref:`Modifying a Parameter Template <en-us_topic_configuration>`.                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 5** Tag

      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                          |
      +===================================+======================================================================================================================================================================================================================+
      | Tags                              | This setting is optional. Adding tags helps you better identify and manage your DB instances. Up to 20 tags can be added for a DB instance.                                                                          |
      |                                   |                                                                                                                                                                                                                      |
      |                                   | A tag is composed of a key-value pair.                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                      |
      |                                   | -  Key: Mandatory if the DB instance is going to be tagged                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                      |
      |                                   |    -  Each tag key must be unique for each DB instance.                                                                                                                                                              |
      |                                   |    -  A tag key consists of up to 36 characters.                                                                                                                                                                     |
      |                                   |    -  The key can only consist of digits, letters, underscores (_), hyphens (-), and at sign (@).                                                                                                                    |
      |                                   |                                                                                                                                                                                                                      |
      |                                   | -  Value: Optional if the DB instance is going to be tagged                                                                                                                                                          |
      |                                   |                                                                                                                                                                                                                      |
      |                                   |    -  The value consists of up to 43 characters.                                                                                                                                                                     |
      |                                   |    -  The key can only consist of digits, letters, underscores (_), hyphens (-), and at sign (@).                                                                                                                    |
      |                                   |                                                                                                                                                                                                                      |
      |                                   | After a DB instance is created, you can view its tag details on the **Tags** tab. In addition, you can add, modify, and delete tags for existing DB instances. For details, see :ref:`Tag Management <dds_03_0023>`. |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      DB instance performance is determined by how you configure it during the creation. The hardware configuration items that can be selected include the class and storage space of the replica set.

#. On the displayed page, confirm the DB instance information.

   -  If you need to modify the specifications, click **Previous** to return to the previous page.
   -  If you do not need to modify the specifications, click **Submit** to start the instance creation.

#. After a DDS DB instance is created, you can view and manage it on the **Instance Management** page.

   -  When a DB instance is being created, the status displayed in the **Status** column is **Creating**. This process takes about 15 minutes. After the creation is complete, the status changes to **Available**.
   -  DDS enables the automated backup policy by default. After a DB instance is created, you can modify or disable the automated backup policy. An automated full backup is immediately triggered after the creation of a DB instance.
   -  The default DDS port is 8635, but this port can be modified if necessary. If you change the port, you need to add the security group rule to enable access.

.. |image1| image:: /_static/images/en-us_image_0000001096293848.png
